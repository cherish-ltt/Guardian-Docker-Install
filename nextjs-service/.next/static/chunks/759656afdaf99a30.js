(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,54858,61664,e=>{"use strict";e.i(34702);let t="/guardian-auth/v1",n={LOGIN:"/auth/login",LOGOUT:"/auth/logout",REFRESH:"/auth/refresh",TWO_FACTOR_SETUP:"/auth/2fa/setup",TWO_FACTOR_VERIFY:"/auth/2fa/verify",TWO_FACTOR_DISABLE:"/auth/2fa/disable",CHANGE_PASSWORD:"/auth/change-password",RESET_PASSWORD:"/auth/reset-password",SYSTEM_INFO:"/systeminfo",ADMINS:"/admins",ROLES:"/roles",PERMISSIONS:"/permissions",PERMISSIONS_TREE:"/permissions/tree"};e.s(["API_BASE_URL",0,t,"API_ENDPOINTS",0,n],61664);class a extends Error{code;data;constructor(e,t,n){super(t),this.code=e,this.data=n,this.name="ApiError"}}let r=!1,o=null;function s(){return localStorage.getItem("access_token")}function i(e){localStorage.setItem("access_token",e),document.cookie=`access_token=${e}; path=/; max-age=900; SameSite=Lax`}function c(e){localStorage.setItem("refresh_token",e)}function d(){localStorage.removeItem("access_token"),document.cookie="access_token=; path=/; max-age=0"}function u(){localStorage.removeItem("refresh_token")}async function l(){let e=localStorage.getItem("refresh_token");if(!e)throw Error("No refresh token available");try{let a=await fetch(`${t}${n.REFRESH}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh_token:e})}),r=await a.json();if(200!==r.code)throw d(),u(),window.location.href="/login",Error("Token refresh failed");return i(r.data.access_token),r.data.access_token}catch(e){throw d(),u(),window.location.href="/login",e}}async function p(e){let t=e.headers.get("content-type");if(!e.ok){let t=e.status,n="出错啦！请稍后再试。";try{let t=await e.json();t.msg&&""!==t.msg.trim()&&(n=t.msg)}catch{}throw new a(t,n)}if(!t||!t.includes("application/json"))throw new a(0,"Invalid response format");let n=await e.json();if(200!==n.code){let e=n.msg&&""!==n.msg.trim()?n.msg:"出错啦！请稍后再试。";throw new a(n.code,e,n.data)}return n.data}async function g(e,t,n){let s=e.headers.get("content-type");if(!e.ok){let t=e.status,n="出错啦！请稍后再试。";try{let t=await e.json();t.msg&&""!==t.msg.trim()&&(n=t.msg)}catch{}throw new a(t,n)}if(!s||!s.includes("application/json"))throw new a(0,"Invalid response format");let i=await e.json();if(17003===i.code||17002===i.code)try{let e="";r?e=await o:(r=!0,o=l(),e=await o,o=null,r=!1);let a=await fetch(t,{...n,headers:{...n.headers,Authorization:`Bearer ${e}`}});return p(a)}catch{throw window.location.href="/login",new a(i.code,"Session expired, please login again")}if(200!==i.code){let e=i.msg&&""!==i.msg.trim()?i.msg:"出错啦！请稍后再试。";throw new a(i.code,e,i.data)}return i.data}async function S(e,n){let a=`${t}${e}`,r={"Content-Type":"application/json",...n?.headers};return p(await fetch(a,{...n,headers:r}))}async function f(e,t){return S(e,{method:"POST",body:t?JSON.stringify(t):void 0})}async function h(e,n){let a=s(),r=`${t}${e}`,o={method:"POST",body:n?JSON.stringify(n):void 0,headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`}};return g(await fetch(r,o),r,o)}async function m(e){let n=s(),a=`${t}${e}`,r={method:"GET",headers:{Authorization:`Bearer ${n}`}};return g(await fetch(a,r),a,r)}async function y(e,n){let a=s(),r=`${t}${e}`,o={method:"PUT",body:n?JSON.stringify(n):void 0,headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`}};return g(await fetch(r,o),r,o)}async function w(e){let n=s(),a=`${t}${e}`,r={method:"DELETE",headers:{Authorization:`Bearer ${n}`}};return g(await fetch(a,r),a,r)}async function $(e){let t=e?`?limit=${e}`:"";return m(`${n.SYSTEM_INFO}${t}`)}async function R(e){return h(n.CHANGE_PASSWORD,{new_password:e})}async function _(e,t,a){return f(n.RESET_PASSWORD,{username:e,two_fa_code:t,new_password:a})}async function E(e){let t=new URLSearchParams;e?.page&&t.append("page",e.page.toString()),e?.page_size&&t.append("page_size",e.page_size.toString()),e?.status!==void 0&&t.append("status",e.status.toString()),e?.keyword&&t.append("keyword",e.keyword);let a=t.toString();return m(`${n.ADMINS}${a?`?${a}`:""}`)}async function A(e){return m(`${n.ADMINS}/${e}`)}async function O(e){return h(n.ADMINS,e)}async function T(e,t){return y(`${n.ADMINS}/${e}`,t)}async function I(e){return w(`${n.ADMINS}/${e}`)}async function k(e,t){return h(`${n.ADMINS}/${e}/roles`,{role_ids:t})}async function P(e){let t=new URLSearchParams;e?.page&&t.append("page",e.page.toString()),e?.page_size&&t.append("page_size",e.page_size.toString()),e?.keyword&&t.append("keyword",e.keyword);let a=t.toString();return m(`${n.ROLES}${a?`?${a}`:""}`)}async function N(e){return m(`${n.ROLES}/${e}`)}async function b(e){return h(n.ROLES,e)}async function j(e,t){return y(`${n.ROLES}/${e}`,t)}async function v(e){return w(`${n.ROLES}/${e}`)}async function L(e){let t=new URLSearchParams;e?.page&&t.append("page",e.page.toString()),e?.page_size&&t.append("page_size",e.page_size.toString()),e?.resource_type&&t.append("resource_type",e.resource_type),e?.keyword&&t.append("keyword",e.keyword);let a=t.toString();return m(`${n.PERMISSIONS}${a?`?${a}`:""}`)}async function M(){return m(n.PERMISSIONS_TREE)}async function x(e){return h(n.PERMISSIONS,e)}async function z(e,t){return y(`${n.PERMISSIONS}/${e}`,t)}async function D(e){return w(`${n.PERMISSIONS}/${e}`)}async function C(e,t){return h(`${n.ROLES}/${e}/permissions`,{permission_ids:t})}e.s(["ApiError",()=>a,"assignPermissionsToRole",()=>C,"assignRolesToAdmin",()=>k,"changePassword",()=>R,"clearAccessToken",()=>d,"clearRefreshToken",()=>u,"createAdmin",()=>O,"createPermission",()=>x,"createRole",()=>b,"deleteAdmin",()=>I,"deletePermission",()=>D,"deleteRole",()=>v,"getAccessToken",()=>s,"getAdmin",()=>A,"getAdmins",()=>E,"getPermissions",()=>L,"getPermissionsTree",()=>M,"getRole",()=>N,"getRoles",()=>P,"getSystemInfo",()=>$,"post",()=>f,"postWithAuth",()=>h,"resetPassword",()=>_,"setAccessToken",()=>i,"setRefreshToken",()=>c,"updateAdmin",()=>T,"updatePermission",()=>z,"updateRole",()=>j],54858)},4520,(e,t,n)=>{t.exports=e.r(26841)},31713,e=>{"use strict";var t=e.i(83638),n=e.i(43447),a=e.i(4520),r=e.i(54858);function o(){let e=(0,a.useRouter)();return(0,n.useEffect)(()=>{(0,r.getAccessToken)()?e.replace("/dashboard"):e.replace("/login")},[e]),(0,t.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-zinc-50 font-sans dark:bg-black",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 dark:border-gray-100 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"加载中..."})]})})}e.s(["default",()=>o])}]);