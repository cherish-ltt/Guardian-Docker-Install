(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,54858,61664,e=>{"use strict";e.i(34702);let t="/guardian-auth/v1",n={LOGIN:"/auth/login",LOGOUT:"/auth/logout",REFRESH:"/auth/refresh",TWO_FACTOR_SETUP:"/auth/2fa/setup",TWO_FACTOR_VERIFY:"/auth/2fa/verify",TWO_FACTOR_DISABLE:"/auth/2fa/disable",CHANGE_PASSWORD:"/auth/change-password",RESET_PASSWORD:"/auth/reset-password",SYSTEM_INFO:"/systeminfo",ADMINS:"/admins",ROLES:"/roles",PERMISSIONS:"/permissions",PERMISSIONS_TREE:"/permissions/tree"};e.s(["API_BASE_URL",0,t,"API_ENDPOINTS",0,n],61664);class a extends Error{code;data;constructor(e,t,n){super(t),this.code=e,this.data=n,this.name="ApiError"}}let r=!1,o=null;function s(){return localStorage.getItem("access_token")}function l(e){localStorage.setItem("access_token",e),document.cookie=`access_token=${e}; path=/; max-age=900; SameSite=Lax`}function i(e){localStorage.setItem("refresh_token",e)}function d(){localStorage.removeItem("access_token"),document.cookie="access_token=; path=/; max-age=0"}function c(){localStorage.removeItem("refresh_token")}async function u(){let e=localStorage.getItem("refresh_token");if(!e)throw Error("No refresh token available");try{let a=await fetch(`${t}${n.REFRESH}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh_token:e})}),r=await a.json();if(200!==r.code)throw d(),c(),window.location.href="/login",Error("Token refresh failed");return l(r.data.access_token),r.data.access_token}catch(e){throw d(),c(),window.location.href="/login",e}}async function p(e){let t=e.headers.get("content-type");if(!e.ok){let t=e.status,n="出错啦！请稍后再试。";try{let t=await e.json();t.msg&&""!==t.msg.trim()&&(n=t.msg)}catch{}throw new a(t,n)}if(!t||!t.includes("application/json"))throw new a(0,"Invalid response format");let n=await e.json();if(200!==n.code){let e=n.msg&&""!==n.msg.trim()?n.msg:"出错啦！请稍后再试。";throw new a(n.code,e,n.data)}return n.data}async function m(e,t,n){let s=e.headers.get("content-type");if(!e.ok){let t=e.status,n="出错啦！请稍后再试。";try{let t=await e.json();t.msg&&""!==t.msg.trim()&&(n=t.msg)}catch{}throw new a(t,n)}if(!s||!s.includes("application/json"))throw new a(0,"Invalid response format");let l=await e.json();if(17003===l.code||17002===l.code)try{let e="";r?e=await o:(r=!0,o=u(),e=await o,o=null,r=!1);let a=await fetch(t,{...n,headers:{...n.headers,Authorization:`Bearer ${e}`}});return p(a)}catch{throw window.location.href="/login",new a(l.code,"Session expired, please login again")}if(200!==l.code){let e=l.msg&&""!==l.msg.trim()?l.msg:"出错啦！请稍后再试。";throw new a(l.code,e,l.data)}return l.data}async function f(e,n){let a=`${t}${e}`,r={"Content-Type":"application/json",...n?.headers};return p(await fetch(a,{...n,headers:r}))}async function h(e,t){return f(e,{method:"POST",body:t?JSON.stringify(t):void 0})}async function g(e,n){let a=s(),r=`${t}${e}`,o={method:"POST",body:n?JSON.stringify(n):void 0,headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`}};return m(await fetch(r,o),r,o)}async function x(e){let n=s(),a=`${t}${e}`,r={method:"GET",headers:{Authorization:`Bearer ${n}`}};return m(await fetch(a,r),a,r)}async function v(e,n){let a=s(),r=`${t}${e}`,o={method:"PUT",body:n?JSON.stringify(n):void 0,headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`}};return m(await fetch(r,o),r,o)}async function w(e){let n=s(),a=`${t}${e}`,r={method:"DELETE",headers:{Authorization:`Bearer ${n}`}};return m(await fetch(a,r),a,r)}async function y(e){let t=e?`?limit=${e}`:"";return x(`${n.SYSTEM_INFO}${t}`)}async function S(e){return g(n.CHANGE_PASSWORD,{new_password:e})}async function b(e,t,a){return h(n.RESET_PASSWORD,{username:e,two_fa_code:t,new_password:a})}async function j(e){let t=new URLSearchParams;e?.page&&t.append("page",e.page.toString()),e?.page_size&&t.append("page_size",e.page_size.toString()),e?.status!==void 0&&t.append("status",e.status.toString()),e?.keyword&&t.append("keyword",e.keyword);let a=t.toString();return x(`${n.ADMINS}${a?`?${a}`:""}`)}async function E(e){return x(`${n.ADMINS}/${e}`)}async function k(e){return g(n.ADMINS,e)}async function _(e,t){return v(`${n.ADMINS}/${e}`,t)}async function N(e){return w(`${n.ADMINS}/${e}`)}async function P(e,t){return g(`${n.ADMINS}/${e}/roles`,{role_ids:t})}async function A(e){let t=new URLSearchParams;e?.page&&t.append("page",e.page.toString()),e?.page_size&&t.append("page_size",e.page_size.toString()),e?.keyword&&t.append("keyword",e.keyword);let a=t.toString();return x(`${n.ROLES}${a?`?${a}`:""}`)}async function R(e){return x(`${n.ROLES}/${e}`)}async function C(e){return g(n.ROLES,e)}async function T(e,t){return v(`${n.ROLES}/${e}`,t)}async function I(e){return w(`${n.ROLES}/${e}`)}async function O(e){let t=new URLSearchParams;e?.page&&t.append("page",e.page.toString()),e?.page_size&&t.append("page_size",e.page_size.toString()),e?.resource_type&&t.append("resource_type",e.resource_type),e?.keyword&&t.append("keyword",e.keyword);let a=t.toString();return x(`${n.PERMISSIONS}${a?`?${a}`:""}`)}async function $(){return x(n.PERMISSIONS_TREE)}async function F(e){return g(n.PERMISSIONS,e)}async function M(e,t){return v(`${n.PERMISSIONS}/${e}`,t)}async function D(e){return w(`${n.PERMISSIONS}/${e}`)}async function L(e,t){return g(`${n.ROLES}/${e}/permissions`,{permission_ids:t})}e.s(["ApiError",()=>a,"assignPermissionsToRole",()=>L,"assignRolesToAdmin",()=>P,"changePassword",()=>S,"clearAccessToken",()=>d,"clearRefreshToken",()=>c,"createAdmin",()=>k,"createPermission",()=>F,"createRole",()=>C,"deleteAdmin",()=>N,"deletePermission",()=>D,"deleteRole",()=>I,"getAccessToken",()=>s,"getAdmin",()=>E,"getAdmins",()=>j,"getPermissions",()=>O,"getPermissionsTree",()=>$,"getRole",()=>R,"getRoles",()=>A,"getSystemInfo",()=>y,"post",()=>h,"postWithAuth",()=>g,"resetPassword",()=>b,"setAccessToken",()=>l,"setRefreshToken",()=>i,"updateAdmin",()=>_,"updatePermission",()=>M,"updateRole",()=>T],54858)},86530,e=>{"use strict";var t=e.i(83638);e.i(43447);var n=e.i(94237),a=e.i(47163),r=e.i(10708);function o({className:e,...n}){return(0,t.jsx)("div",{"data-slot":"field-group",className:(0,a.cn)("group/field-group @container/field-group flex w-full flex-col gap-7 data-[slot=checkbox-group]:gap-3 [&>[data-slot=field-group]]:gap-4",e),...n})}e.i(69035);let s=(0,n.cva)("group/field flex w-full gap-3 data-[invalid=true]:text-destructive",{variants:{orientation:{vertical:["flex-col [&>*]:w-full [&>.sr-only]:w-auto"],horizontal:["flex-row items-center","[&>[data-slot=field-label]]:flex-auto","has-[>[data-slot=field-content]]:items-start has-[>[data-slot=field-content]]:[&>[role=checkbox],[role=radio]]:mt-px"],responsive:["flex-col [&>*]:w-full [&>.sr-only]:w-auto @md/field-group:flex-row @md/field-group:items-center @md/field-group:[&>*]:w-auto","@md/field-group:[&>[data-slot=field-label]]:flex-auto","@md/field-group:has-[>[data-slot=field-content]]:items-start @md/field-group:has-[>[data-slot=field-content]]:[&>[role=checkbox],[role=radio]]:mt-px"]}},defaultVariants:{orientation:"vertical"}});function l({className:e,orientation:n="vertical",...r}){return(0,t.jsx)("div",{role:"group","data-slot":"field","data-orientation":n,className:(0,a.cn)(s({orientation:n}),e),...r})}function i({className:e,...n}){return(0,t.jsx)(r.Label,{"data-slot":"field-label",className:(0,a.cn)("group/field-label peer/field-label flex w-fit gap-2 leading-snug group-data-[disabled=true]/field:opacity-50","has-[>[data-slot=field]]:w-full has-[>[data-slot=field]]:flex-col has-[>[data-slot=field]]:rounded-md has-[>[data-slot=field]]:border [&>*]:data-[slot=field]:p-4","has-data-[state=checked]:bg-primary/5 has-data-[state=checked]:border-primary dark:has-data-[state=checked]:bg-primary/10",e),...n})}function d({className:e,...n}){return(0,t.jsx)("p",{"data-slot":"field-description",className:(0,a.cn)("text-muted-foreground text-sm leading-normal font-normal group-has-[[data-orientation=horizontal]]/field:text-balance","last:mt-0 nth-last-2:-mt-1 [[data-variant=legend]+&]:-mt-1.5","[&>a:hover]:text-primary [&>a]:underline [&>a]:underline-offset-4",e),...n})}e.s(["Field",()=>l,"FieldDescription",()=>d,"FieldGroup",()=>o,"FieldLabel",()=>i])},89954,e=>{"use strict";var t=e.i(83638),n=e.i(43447),a=e.i(98631);let r=(0,a.default)("gallery-vertical-end",[["path",{d:"M7 2h10",key:"nczekb"}],["path",{d:"M5 6h14",key:"u2x4p"}],["rect",{width:"18",height:"12",x:"3",y:"10",rx:"2",key:"l0tzu3"}]]);var o=e.i(47163),s=e.i(67881),l=e.i(86530),i=e.i(23750),d=Object.defineProperty,c=Object.defineProperties,u=Object.getOwnPropertyDescriptors,p=Object.getOwnPropertySymbols,m=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable,h=(e,t,n)=>t in e?d(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,g=n.createContext({}),x=n.forwardRef((e,t)=>{let a;var r,o,s,l,i,{value:d,onChange:x,maxLength:y,textAlign:S="left",pattern:b,placeholder:j,inputMode:E="numeric",onComplete:k,pushPasswordManagerStrategy:_="increase-width",pasteTransformer:N,containerClassName:P,noScriptCSSFallback:A=w,render:R,children:C}=e,T=((e,t)=>{var n={};for(var a in e)m.call(e,a)&&0>t.indexOf(a)&&(n[a]=e[a]);if(null!=e&&p)for(var a of p(e))0>t.indexOf(a)&&f.call(e,a)&&(n[a]=e[a]);return n})(e,["value","onChange","maxLength","textAlign","pattern","placeholder","inputMode","onComplete","pushPasswordManagerStrategy","pasteTransformer","containerClassName","noScriptCSSFallback","render","children"]);let[I,O]=n.useState("string"==typeof T.defaultValue?T.defaultValue:""),$=null!=d?d:I,F=(a=n.useRef(),n.useEffect(()=>{a.current=$}),a.current),M=n.useCallback(e=>{null==x||x(e),O(e)},[x]),D=n.useMemo(()=>b?"string"==typeof b?new RegExp(b):b:null,[b]),L=n.useRef(null),B=n.useRef(null),z=n.useRef({value:$,onChange:M,isIOS:"undefined"!=typeof window&&(null==(o=null==(r=null==window?void 0:window.CSS)?void 0:r.supports)?void 0:o.call(r,"-webkit-touch-callout","none"))}),W=n.useRef({prev:[null==(s=L.current)?void 0:s.selectionStart,null==(l=L.current)?void 0:l.selectionEnd,null==(i=L.current)?void 0:i.selectionDirection]});n.useImperativeHandle(t,()=>L.current,[]),n.useEffect(()=>{let e=L.current,t=B.current;if(!e||!t)return;function n(){if(document.activeElement!==e){J(null),K(null);return}let t=e.selectionStart,n=e.selectionEnd,a=e.selectionDirection,r=e.maxLength,o=e.value,s=W.current.prev,l=-1,i=-1,d;if(0!==o.length&&null!==t&&null!==n){let e=t===n,a=t===o.length&&o.length<r;if(e&&!a){if(0===t)l=0,i=1,d="forward";else if(t===r)l=t-1,i=t,d="backward";else if(r>1&&o.length>1){let e=0;if(null!==s[0]&&null!==s[1]){d=t<s[1]?"backward":"forward";let n=s[0]===s[1]&&s[0]<r;"backward"!==d||n||(e=-1)}l=e+t,i=e+t+1}}-1!==l&&-1!==i&&l!==i&&L.current.setSelectionRange(l,i,d)}let c=-1!==l?l:t,u=-1!==i?i:n,p=null!=d?d:a;J(c),K(u),W.current.prev=[c,u,p]}if(z.current.value!==e.value&&z.current.onChange(e.value),W.current.prev=[e.selectionStart,e.selectionEnd,e.selectionDirection],document.addEventListener("selectionchange",n,{capture:!0}),n(),document.activeElement===e&&q(!0),!document.getElementById("input-otp-style")){let e=document.createElement("style");if(e.id="input-otp-style",document.head.appendChild(e),e.sheet){let t="background: transparent !important; color: transparent !important; border-color: transparent !important; opacity: 0 !important; box-shadow: none !important; -webkit-box-shadow: none !important; -webkit-text-fill-color: transparent !important;";v(e.sheet,"[data-input-otp]::selection { background: transparent !important; color: transparent !important; }"),v(e.sheet,`[data-input-otp]:autofill { ${t} }`),v(e.sheet,`[data-input-otp]:-webkit-autofill { ${t} }`),v(e.sheet,"@supports (-webkit-touch-callout: none) { [data-input-otp] { letter-spacing: -.6em !important; font-weight: 100 !important; font-stretch: ultra-condensed; font-optical-sizing: none !important; left: -1px !important; right: 1px !important; } }"),v(e.sheet,"[data-input-otp] + * { pointer-events: all !important; }")}}let a=()=>{t&&t.style.setProperty("--root-height",`${e.clientHeight}px`)};a();let r=new ResizeObserver(a);return r.observe(e),()=>{document.removeEventListener("selectionchange",n,{capture:!0}),r.disconnect()}},[]);let[H,G]=n.useState(!1),[U,q]=n.useState(!1),[V,J]=n.useState(null),[Y,K]=n.useState(null);n.useEffect(()=>{var e;setTimeout(e=()=>{var e,t,n,a;null==(e=L.current)||e.dispatchEvent(new Event("input"));let r=null==(t=L.current)?void 0:t.selectionStart,o=null==(n=L.current)?void 0:n.selectionEnd,s=null==(a=L.current)?void 0:a.selectionDirection;null!==r&&null!==o&&(J(r),K(o),W.current.prev=[r,o,s])},0),setTimeout(e,10),setTimeout(e,50)},[$,U]),n.useEffect(()=>{void 0!==F&&$!==F&&F.length<y&&$.length===y&&(null==k||k($))},[y,k,F,$]);let Q=function({containerRef:e,inputRef:t,pushPasswordManagerStrategy:a,isFocused:r}){let[o,s]=n.useState(!1),[l,i]=n.useState(!1),[d,c]=n.useState(!1),u=n.useMemo(()=>"none"!==a&&("increase-width"===a||"experimental-no-flickering"===a)&&o&&l,[o,l,a]),p=n.useCallback(()=>{let n=e.current,r=t.current;if(!n||!r||d||"none"===a)return;let o=n.getBoundingClientRect().left+n.offsetWidth,l=n.getBoundingClientRect().top+n.offsetHeight/2;0===document.querySelectorAll('[data-lastpass-icon-root],com-1password-button,[data-dashlanecreated],[style$="2147483647 !important;"]').length&&document.elementFromPoint(o-18,l)===n||(s(!0),c(!0))},[e,t,d,a]);return n.useEffect(()=>{let t=e.current;if(!t||"none"===a)return;function n(){i(window.innerWidth-t.getBoundingClientRect().right>=40)}n();let r=setInterval(n,1e3);return()=>{clearInterval(r)}},[e,a]),n.useEffect(()=>{let e=r||document.activeElement===t.current;if("none"===a||!e)return;let n=setTimeout(p,0),o=setTimeout(p,2e3),s=setTimeout(p,5e3),l=setTimeout(()=>{c(!0)},6e3);return()=>{clearTimeout(n),clearTimeout(o),clearTimeout(s),clearTimeout(l)}},[t,r,a,p]),{hasPWMBadge:o,willPushPWMBadge:u,PWM_BADGE_SPACE_WIDTH:"40px"}}({containerRef:B,inputRef:L,pushPasswordManagerStrategy:_,isFocused:U}),X=n.useCallback(e=>{let t=e.currentTarget.value.slice(0,y);t.length>0&&D&&!D.test(t)?e.preventDefault():("string"==typeof F&&t.length<F.length&&document.dispatchEvent(new Event("selectionchange")),M(t))},[y,M,F,D]),Z=n.useCallback(()=>{var e;if(L.current){let t=Math.min(L.current.value.length,y-1),n=L.current.value.length;null==(e=L.current)||e.setSelectionRange(t,n),J(t),K(n)}q(!0)},[y]),ee=n.useCallback(e=>{var t,n;let a=L.current;if(!N&&(!z.current.isIOS||!e.clipboardData||!a))return;let r=e.clipboardData.getData("text/plain"),o=N?N(r):r;e.preventDefault();let s=null==(t=L.current)?void 0:t.selectionStart,l=null==(n=L.current)?void 0:n.selectionEnd,i=(s!==l?$.slice(0,s)+o+$.slice(l):$.slice(0,s)+o+$.slice(s)).slice(0,y);if(i.length>0&&D&&!D.test(i))return;a.value=i,M(i);let d=Math.min(i.length,y-1),c=i.length;a.setSelectionRange(d,c),J(d),K(c)},[y,M,D,$]),et=n.useMemo(()=>({position:"relative",cursor:T.disabled?"default":"text",userSelect:"none",WebkitUserSelect:"none",pointerEvents:"none"}),[T.disabled]),en=n.useMemo(()=>({position:"absolute",inset:0,width:Q.willPushPWMBadge?`calc(100% + ${Q.PWM_BADGE_SPACE_WIDTH})`:"100%",clipPath:Q.willPushPWMBadge?`inset(0 ${Q.PWM_BADGE_SPACE_WIDTH} 0 0)`:void 0,height:"100%",display:"flex",textAlign:S,opacity:"1",color:"transparent",pointerEvents:"all",background:"transparent",caretColor:"transparent",border:"0 solid transparent",outline:"0 solid transparent",boxShadow:"none",lineHeight:"1",letterSpacing:"-.5em",fontSize:"var(--root-height)",fontFamily:"monospace",fontVariantNumeric:"tabular-nums"}),[Q.PWM_BADGE_SPACE_WIDTH,Q.willPushPWMBadge,S]),ea=n.useMemo(()=>n.createElement("input",c(((e,t)=>{for(var n in t||(t={}))m.call(t,n)&&h(e,n,t[n]);if(p)for(var n of p(t))f.call(t,n)&&h(e,n,t[n]);return e})({autoComplete:T.autoComplete||"one-time-code"},T),u({"data-input-otp":!0,"data-input-otp-placeholder-shown":0===$.length||void 0,"data-input-otp-mss":V,"data-input-otp-mse":Y,inputMode:E,pattern:null==D?void 0:D.source,"aria-placeholder":j,style:en,maxLength:y,value:$,ref:L,onPaste:e=>{var t;ee(e),null==(t=T.onPaste)||t.call(T,e)},onChange:X,onMouseOver:e=>{var t;G(!0),null==(t=T.onMouseOver)||t.call(T,e)},onMouseLeave:e=>{var t;G(!1),null==(t=T.onMouseLeave)||t.call(T,e)},onFocus:e=>{var t;Z(),null==(t=T.onFocus)||t.call(T,e)},onBlur:e=>{var t;q(!1),null==(t=T.onBlur)||t.call(T,e)}}))),[X,Z,ee,E,en,y,Y,V,T,null==D?void 0:D.source,$]),er=n.useMemo(()=>({slots:Array.from({length:y}).map((e,t)=>{var n;let a=U&&null!==V&&null!==Y&&(V===Y&&t===V||t>=V&&t<Y),r=void 0!==$[t]?$[t]:null;return{char:r,placeholderChar:void 0!==$[0]?null:null!=(n=null==j?void 0:j[t])?n:null,isActive:a,hasFakeCaret:a&&null===r}}),isFocused:U,isHovering:!T.disabled&&H}),[U,H,y,Y,V,T.disabled,$]),eo=n.useMemo(()=>R?R(er):n.createElement(g.Provider,{value:er},C),[C,er,R]);return n.createElement(n.Fragment,null,null!==A&&n.createElement("noscript",null,n.createElement("style",null,A)),n.createElement("div",{ref:B,"data-input-otp-container":!0,style:et,className:P},eo,n.createElement("div",{style:{position:"absolute",inset:0,pointerEvents:"none"}},ea)))});function v(e,t){try{e.insertRule(t)}catch(e){console.error("input-otp could not insert CSS rule:",t)}}x.displayName="Input";var w=`
[data-input-otp] {
  --nojs-bg: white !important;
  --nojs-fg: black !important;

  background-color: var(--nojs-bg) !important;
  color: var(--nojs-fg) !important;
  caret-color: var(--nojs-fg) !important;
  letter-spacing: .25em !important;
  text-align: center !important;
  border: 1px solid var(--nojs-fg) !important;
  border-radius: 4px !important;
  width: 100% !important;
}
@media (prefers-color-scheme: dark) {
  [data-input-otp] {
    --nojs-bg: black !important;
    --nojs-fg: white !important;
  }
}`;let y=(0,a.default)("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);function S({className:e,containerClassName:n,...a}){return(0,t.jsx)(x,{"data-slot":"input-otp",containerClassName:(0,o.cn)("flex items-center gap-2 has-disabled:opacity-50",n),className:(0,o.cn)("disabled:cursor-not-allowed",e),...a})}function b({className:e,...n}){return(0,t.jsx)("div",{"data-slot":"input-otp-group",className:(0,o.cn)("flex items-center",e),...n})}function j({index:e,className:a,...r}){let s=n.useContext(g),{char:l,hasFakeCaret:i,isActive:d}=s?.slots[e]??{};return(0,t.jsxs)("div",{"data-slot":"input-otp-slot","data-active":d,className:(0,o.cn)("data-[active=true]:border-ring data-[active=true]:ring-ring/50 data-[active=true]:aria-invalid:ring-destructive/20 dark:data-[active=true]:aria-invalid:ring-destructive/40 aria-invalid:border-destructive data-[active=true]:aria-invalid:border-destructive dark:bg-input/30 border-input relative flex h-9 w-9 items-center justify-center border-y border-r text-sm shadow-xs transition-all outline-none first:rounded-l-md first:border-l last:rounded-r-md data-[active=true]:z-10 data-[active=true]:ring-[3px]",a),...r,children:[l,i&&(0,t.jsx)("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-caret-blink bg-foreground h-4 w-px duration-1000"})})]})}function E({...e}){return(0,t.jsx)("div",{"data-slot":"input-otp-separator",role:"separator",...e,children:(0,t.jsx)(y,{})})}var k=e.i(61664),_=e.i(54858);function N({className:e,...a}){let[r,d]=(0,n.useState)({username:"",password:"",two_fa_code:""}),[c,u]=(0,n.useState)(!1),[p,m]=(0,n.useState)(!1),[f,h]=(0,n.useState)(null),g=e=>{let{id:t,value:n}=e.target;d(e=>({...e,[t]:n})),h(null)},x=async e=>{e.preventDefault(),m(!0),h(null);try{let e={username:r.username,password:r.password};c&&r.two_fa_code&&(e.two_fa_code=r.two_fa_code);let t=await (0,_.post)(k.API_ENDPOINTS.LOGIN,e);(0,_.setAccessToken)(t.access_token),(0,_.setRefreshToken)(t.refresh_token),c&&r.two_fa_code?window.location.href="/dashboard":window.location.href="/2fa"}catch(e){e instanceof _.ApiError?17007===e.code||17008===e.code?(u(!0),h(e.message||"需要 2FA 验证")):17009===e.code?(u(!0),h(e.message||"账户需要 2FA 验证")):h(e.message||"登录失败"):h("发生未知错误，请稍后重试")}finally{m(!1)}};return(0,t.jsx)("form",{className:(0,o.cn)("flex flex-col gap-6",e),...a,onSubmit:x,children:(0,t.jsxs)(l.FieldGroup,{children:[(0,t.jsxs)("div",{className:"flex flex-col items-center gap-1 text-center",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"管理后台 · Login"}),(0,t.jsx)("p",{className:"text-muted-foreground text-sm text-balance",children:"在下方输入您的管理员账号以登录"})]}),f&&(0,t.jsx)("div",{className:"bg-destructive/10 text-destructive text-sm p-3 rounded-md",children:f}),(0,t.jsxs)(l.Field,{children:[(0,t.jsx)(l.FieldLabel,{htmlFor:"username",children:"账号"}),(0,t.jsx)(i.Input,{id:"username",placeholder:"账号名",value:r.username,onChange:g,disabled:p,required:!0})]}),(0,t.jsxs)(l.Field,{children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(l.FieldLabel,{htmlFor:"password",children:"密码"}),(0,t.jsx)("button",{type:"button",onClick:()=>{u(!c),h(null)},className:"ml-auto text-sm underline-offset-4 hover:underline",disabled:p,children:c?"取消 2FA 验证":"需要 2FA 验证?"})]}),(0,t.jsx)(i.Input,{id:"password",type:"password",value:r.password,onChange:g,disabled:p,required:!0})]}),c&&(0,t.jsxs)(l.Field,{children:[(0,t.jsx)(l.FieldLabel,{htmlFor:"otp",children:"2FA-Code"}),(0,t.jsxs)(S,{maxLength:6,id:"otp",value:r.two_fa_code,onChange:e=>{d(t=>({...t,two_fa_code:e})),h(null)},disabled:p,children:[(0,t.jsxs)(b,{className:"gap-2 *:data-[slot=input-otp-slot]:rounded-md *:data-[slot=input-otp-slot]:border",children:[(0,t.jsx)(j,{index:0}),(0,t.jsx)(j,{index:1})]}),(0,t.jsx)(E,{}),(0,t.jsxs)(b,{className:"gap-2 *:data-[slot=input-otp-slot]:rounded-md *:data-[slot=input-otp-slot]:border",children:[(0,t.jsx)(j,{index:2}),(0,t.jsx)(j,{index:3})]}),(0,t.jsx)(E,{}),(0,t.jsxs)(b,{className:"gap-2 *:data-[slot=input-otp-slot]:rounded-md *:data-[slot=input-otp-slot]:border",children:[(0,t.jsx)(j,{index:4}),(0,t.jsx)(j,{index:5})]})]}),(0,t.jsx)(l.FieldDescription,{className:"text-center",children:"请输入您的6位数字代码"})]}),(0,t.jsx)(l.Field,{children:(0,t.jsx)(s.Button,{type:"submit",className:"w-full",disabled:p,children:p?"登录中...":"登录"})})]})})}var P=e.i(30374),A=e.i(10708),R=e.i(54219);function C({isOpen:e,onClose:a}){let[r,o]=(0,n.useState)(""),[l,d]=(0,n.useState)(""),[c,u]=(0,n.useState)(""),[p,m]=(0,n.useState)(""),[f,h]=(0,n.useState)(!1),g=async e=>{if(e.preventDefault(),!r||!l||!c)return void R.toast.error("请填写所有字段");if(c!==p)return void R.toast.error("两次密码输入不一致");if(c.length<6)return void R.toast.error("密码长度至少为 6 位");if(6!==l.length)return void R.toast.error("2FA 验证码必须是 6 位数字");h(!0);try{await (0,_.resetPassword)(r,l,c),R.toast.success("密码重置成功"),a(),o(""),d(""),u(""),m("")}catch(e){e instanceof _.ApiError?R.toast.error(e.message||"密码重置失败"):R.toast.error("发生未知错误，请稍后重试")}finally{h(!1)}};return(0,t.jsx)(P.Dialog,{open:e,onOpenChange:a,children:(0,t.jsxs)(P.DialogContent,{children:[(0,t.jsxs)(P.DialogHeader,{children:[(0,t.jsx)(P.DialogTitle,{children:"重置密码"}),(0,t.jsx)(P.DialogDescription,{children:"通过 2FA 验证码重置密码，无需登录"})]}),(0,t.jsxs)("form",{onSubmit:g,children:[(0,t.jsxs)("div",{className:"space-y-4 py-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(A.Label,{htmlFor:"username",children:"用户名"}),(0,t.jsx)(i.Input,{id:"username",value:r,onChange:e=>o(e.target.value),required:!0,disabled:f,placeholder:"请输入用户名"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(A.Label,{htmlFor:"twoFaCode",children:"2FA 验证码"}),(0,t.jsxs)(S,{maxLength:6,value:l,onChange:d,disabled:f,children:[(0,t.jsxs)(b,{children:[(0,t.jsx)(j,{index:0}),(0,t.jsx)(j,{index:1})]}),(0,t.jsxs)(b,{children:[(0,t.jsx)(j,{index:2}),(0,t.jsx)(j,{index:3})]}),(0,t.jsxs)(b,{children:[(0,t.jsx)(j,{index:4}),(0,t.jsx)(j,{index:5})]})]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"请输入 6 位数字验证码"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(A.Label,{htmlFor:"newPassword",children:"新密码"}),(0,t.jsx)(i.Input,{id:"newPassword",type:"password",value:c,onChange:e=>u(e.target.value),required:!0,disabled:f,placeholder:"请输入新密码（至少 6 位）",autoComplete:"new-password"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(A.Label,{htmlFor:"confirmPassword",children:"确认密码"}),(0,t.jsx)(i.Input,{id:"confirmPassword",type:"password",value:p,onChange:e=>m(e.target.value),required:!0,disabled:f,placeholder:"请再次输入新密码",autoComplete:"new-password"})]})]}),(0,t.jsxs)(P.DialogFooter,{children:[(0,t.jsx)(s.Button,{type:"button",variant:"outline",onClick:a,disabled:f,children:"取消"}),(0,t.jsx)(s.Button,{type:"submit",disabled:f,children:f?"重置中...":"确认重置"})]})]})]})})}function T(){let[e,a]=(0,n.useState)(!1);return(0,t.jsxs)("div",{className:"grid min-h-svh lg:grid-cols-2",children:[(0,t.jsx)("div",{className:"bg-muted relative hidden lg:block",children:(0,t.jsx)("img",{src:"/login-background.png",alt:"Image",className:"absolute inset-0 h-full w-full object-cover dark:brightness-[0.2] dark:grayscale"})}),(0,t.jsxs)("div",{className:"flex flex-col gap-4 p-6 md:p-10",children:[(0,t.jsx)("div",{className:"flex justify-center gap-2 md:justify-start",children:(0,t.jsxs)("a",{href:"#",className:"flex items-center gap-2 font-medium",children:[(0,t.jsx)("div",{className:"bg-primary text-primary-foreground flex size-6 items-center justify-center rounded-md",children:(0,t.jsx)(r,{className:"size-4"})}),"Guardian 管理后台"]})}),(0,t.jsx)("div",{className:"flex flex-1 items-center justify-center",children:(0,t.jsxs)("div",{className:"w-full max-w-xs",children:[(0,t.jsx)(N,{}),(0,t.jsx)("button",{type:"button",onClick:()=>a(!0),className:"text-sm text-muted-foreground hover:text-foreground underline-offset-4 hover:underline mt-4",children:"忘记密码？"}),(0,t.jsx)(C,{isOpen:e,onClose:()=>a(!1)})]})})]})]})}e.s(["default",()=>T],89954)}]);