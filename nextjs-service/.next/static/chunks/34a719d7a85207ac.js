(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,21060,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"warnOnce",{enumerable:!0,get:function(){return s}});let s=e=>{}},54858,61664,e=>{"use strict";e.i(34702);let t="/guardian-auth/v1",r={LOGIN:"/auth/login",LOGOUT:"/auth/logout",REFRESH:"/auth/refresh",TWO_FACTOR_SETUP:"/auth/2fa/setup",TWO_FACTOR_VERIFY:"/auth/2fa/verify",TWO_FACTOR_DISABLE:"/auth/2fa/disable",CHANGE_PASSWORD:"/auth/change-password",RESET_PASSWORD:"/auth/reset-password",SYSTEM_INFO:"/systeminfo",ADMINS:"/admins",ROLES:"/roles",PERMISSIONS:"/permissions",PERMISSIONS_TREE:"/permissions/tree"};e.s(["API_BASE_URL",0,t,"API_ENDPOINTS",0,r],61664);class s extends Error{code;data;constructor(e,t,r){super(t),this.code=e,this.data=r,this.name="ApiError"}}let a=!1,n=null;function i(){return localStorage.getItem("access_token")}function o(e){localStorage.setItem("access_token",e),document.cookie=`access_token=${e}; path=/; max-age=900; SameSite=Lax`}function c(e){localStorage.setItem("refresh_token",e)}function d(){localStorage.removeItem("access_token"),document.cookie="access_token=; path=/; max-age=0"}function l(){localStorage.removeItem("refresh_token")}async function u(){let e=localStorage.getItem("refresh_token");if(!e)throw Error("No refresh token available");try{let s=await fetch(`${t}${r.REFRESH}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh_token:e})}),a=await s.json();if(200!==a.code)throw d(),l(),window.location.href="/login",Error("Token refresh failed");return o(a.data.access_token),a.data.access_token}catch(e){throw d(),l(),window.location.href="/login",e}}async function h(e){let t=e.headers.get("content-type");if(!e.ok){let t=e.status,r="出错啦！请稍后再试。";try{let t=await e.json();t.msg&&""!==t.msg.trim()&&(r=t.msg)}catch{}throw new s(t,r)}if(!t||!t.includes("application/json"))throw new s(0,"Invalid response format");let r=await e.json();if(200!==r.code){let e=r.msg&&""!==r.msg.trim()?r.msg:"出错啦！请稍后再试。";throw new s(r.code,e,r.data)}return r.data}async function m(e,t,r){let i=e.headers.get("content-type");if(!e.ok){let t=e.status,r="出错啦！请稍后再试。";try{let t=await e.json();t.msg&&""!==t.msg.trim()&&(r=t.msg)}catch{}throw new s(t,r)}if(!i||!i.includes("application/json"))throw new s(0,"Invalid response format");let o=await e.json();if(17003===o.code||17002===o.code)try{let e="";a?e=await n:(a=!0,n=u(),e=await n,n=null,a=!1);let s=await fetch(t,{...r,headers:{...r.headers,Authorization:`Bearer ${e}`}});return h(s)}catch{throw window.location.href="/login",new s(o.code,"Session expired, please login again")}if(200!==o.code){let e=o.msg&&""!==o.msg.trim()?o.msg:"出错啦！请稍后再试。";throw new s(o.code,e,o.data)}return o.data}async function p(e,r){let s=`${t}${e}`,a={"Content-Type":"application/json",...r?.headers};return h(await fetch(s,{...r,headers:a}))}async function x(e,t){return p(e,{method:"POST",body:t?JSON.stringify(t):void 0})}async function f(e,r){let s=i(),a=`${t}${e}`,n={method:"POST",body:r?JSON.stringify(r):void 0,headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`}};return m(await fetch(a,n),a,n)}async function g(e){let r=i(),s=`${t}${e}`,a={method:"GET",headers:{Authorization:`Bearer ${r}`}};return m(await fetch(s,a),s,a)}async function v(e,r){let s=i(),a=`${t}${e}`,n={method:"PUT",body:r?JSON.stringify(r):void 0,headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`}};return m(await fetch(a,n),a,n)}async function b(e){let r=i(),s=`${t}${e}`,a={method:"DELETE",headers:{Authorization:`Bearer ${r}`}};return m(await fetch(s,a),s,a)}async function y(e){let t=e?`?limit=${e}`:"";return g(`${r.SYSTEM_INFO}${t}`)}async function j(e){return f(r.CHANGE_PASSWORD,{new_password:e})}async function S(e,t,s){return x(r.RESET_PASSWORD,{username:e,two_fa_code:t,new_password:s})}async function w(e){let t=new URLSearchParams;e?.page&&t.append("page",e.page.toString()),e?.page_size&&t.append("page_size",e.page_size.toString()),e?.status!==void 0&&t.append("status",e.status.toString()),e?.keyword&&t.append("keyword",e.keyword);let s=t.toString();return g(`${r.ADMINS}${s?`?${s}`:""}`)}async function k(e){return g(`${r.ADMINS}/${e}`)}async function N(e){return f(r.ADMINS,e)}async function T(e,t){return v(`${r.ADMINS}/${e}`,t)}async function _(e){return b(`${r.ADMINS}/${e}`)}async function R(e,t){return f(`${r.ADMINS}/${e}/roles`,{role_ids:t})}async function E(e){let t=new URLSearchParams;e?.page&&t.append("page",e.page.toString()),e?.page_size&&t.append("page_size",e.page_size.toString()),e?.keyword&&t.append("keyword",e.keyword);let s=t.toString();return g(`${r.ROLES}${s?`?${s}`:""}`)}async function C(e){return g(`${r.ROLES}/${e}`)}async function $(e){return f(r.ROLES,e)}async function A(e,t){return v(`${r.ROLES}/${e}`,t)}async function I(e){return b(`${r.ROLES}/${e}`)}async function O(e){let t=new URLSearchParams;e?.page&&t.append("page",e.page.toString()),e?.page_size&&t.append("page_size",e.page_size.toString()),e?.resource_type&&t.append("resource_type",e.resource_type),e?.keyword&&t.append("keyword",e.keyword);let s=t.toString();return g(`${r.PERMISSIONS}${s?`?${s}`:""}`)}async function P(){return g(r.PERMISSIONS_TREE)}async function L(e){return f(r.PERMISSIONS,e)}async function D(e,t){return v(`${r.PERMISSIONS}/${e}`,t)}async function z(e){return b(`${r.PERMISSIONS}/${e}`)}async function B(e,t){return f(`${r.ROLES}/${e}/permissions`,{permission_ids:t})}e.s(["ApiError",()=>s,"assignPermissionsToRole",()=>B,"assignRolesToAdmin",()=>R,"changePassword",()=>j,"clearAccessToken",()=>d,"clearRefreshToken",()=>l,"createAdmin",()=>N,"createPermission",()=>L,"createRole",()=>$,"deleteAdmin",()=>_,"deletePermission",()=>z,"deleteRole",()=>I,"getAccessToken",()=>i,"getAdmin",()=>k,"getAdmins",()=>w,"getPermissions",()=>O,"getPermissionsTree",()=>P,"getRole",()=>C,"getRoles",()=>E,"getSystemInfo",()=>y,"post",()=>x,"postWithAuth",()=>f,"resetPassword",()=>S,"setAccessToken",()=>o,"setRefreshToken",()=>c,"updateAdmin",()=>T,"updatePermission",()=>D,"updateRole",()=>A],54858)},4520,(e,t,r)=>{t.exports=e.r(26841)},94179,47627,e=>{"use strict";var t=e.i(83638),r=e.i(44095),s=e.i(94237),a=e.i(47163);let n=(0,s.cva)("inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function i({className:e,variant:s,asChild:i=!1,...o}){let c=i?r.Slot:"span";return(0,t.jsx)(c,{"data-slot":"badge",className:(0,a.cn)(n({variant:s}),e),...o})}function o({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,t.jsx)("table",{"data-slot":"table",className:(0,a.cn)("w-full caption-bottom text-sm",e),...r})})}function c({className:e,...r}){return(0,t.jsx)("thead",{"data-slot":"table-header",className:(0,a.cn)("[&_tr]:border-b",e),...r})}function d({className:e,...r}){return(0,t.jsx)("tbody",{"data-slot":"table-body",className:(0,a.cn)("[&_tr:last-child]:border-0",e),...r})}function l({className:e,...r}){return(0,t.jsx)("tr",{"data-slot":"table-row",className:(0,a.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...r})}function u({className:e,...r}){return(0,t.jsx)("th",{"data-slot":"table-head",className:(0,a.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...r})}function h({className:e,...r}){return(0,t.jsx)("td",{"data-slot":"table-cell",className:(0,a.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...r})}e.s(["Badge",()=>i],94179),e.s(["Table",()=>o,"TableBody",()=>d,"TableCell",()=>h,"TableHead",()=>u,"TableHeader",()=>c,"TableRow",()=>l],47627)},25959,e=>{"use strict";var t=e.i(83638),r=e.i(43447),s=e.i(44340),a=e.i(26250),n=e.i(91967),i=e.i(28864),o=e.i(38437),c=e.i(88295),d=e.i(19462),l=e.i(83864),u="Checkbox",[h,m]=(0,a.createContextScope)(u),[p,x]=h(u);function f(e){let{__scopeCheckbox:s,checked:a,children:n,defaultChecked:o,disabled:c,form:d,name:l,onCheckedChange:h,required:m,value:x="on",internal_do_not_use_render:f}=e,[g,v]=(0,i.useControllableState)({prop:a,defaultProp:o??!1,onChange:h,caller:u}),[b,y]=r.useState(null),[j,S]=r.useState(null),w=r.useRef(!1),N=!b||!!d||!!b.closest("form"),T={checked:g,disabled:c,setChecked:v,control:b,setControl:y,name:l,form:d,value:x,hasConsumerStoppedPropagationRef:w,required:m,defaultChecked:!k(o)&&o,isFormControl:N,bubbleInput:j,setBubbleInput:S};return(0,t.jsx)(p,{scope:s,...T,children:"function"==typeof f?f(T):n})}var g="CheckboxTrigger",v=r.forwardRef(({__scopeCheckbox:e,onKeyDown:a,onClick:i,...o},c)=>{let{control:d,value:u,disabled:h,checked:m,required:p,setControl:f,setChecked:v,hasConsumerStoppedPropagationRef:b,isFormControl:y,bubbleInput:j}=x(g,e),S=(0,s.useComposedRefs)(c,f),w=r.useRef(m);return r.useEffect(()=>{let e=d?.form;if(e){let t=()=>v(w.current);return e.addEventListener("reset",t),()=>e.removeEventListener("reset",t)}},[d,v]),(0,t.jsx)(l.Primitive.button,{type:"button",role:"checkbox","aria-checked":k(m)?"mixed":m,"aria-required":p,"data-state":N(m),"data-disabled":h?"":void 0,disabled:h,value:u,...o,ref:S,onKeyDown:(0,n.composeEventHandlers)(a,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,n.composeEventHandlers)(i,e=>{v(e=>!!k(e)||!e),j&&y&&(b.current=e.isPropagationStopped(),b.current||e.stopPropagation())})})});v.displayName=g;var b=r.forwardRef((e,r)=>{let{__scopeCheckbox:s,name:a,checked:n,defaultChecked:i,required:o,disabled:c,value:d,onCheckedChange:l,form:u,...h}=e;return(0,t.jsx)(f,{__scopeCheckbox:s,checked:n,defaultChecked:i,disabled:c,required:o,onCheckedChange:l,name:a,form:u,value:d,internal_do_not_use_render:({isFormControl:e})=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v,{...h,ref:r,__scopeCheckbox:s}),e&&(0,t.jsx)(w,{__scopeCheckbox:s})]})})});b.displayName=u;var y="CheckboxIndicator",j=r.forwardRef((e,r)=>{let{__scopeCheckbox:s,forceMount:a,...n}=e,i=x(y,s);return(0,t.jsx)(d.Presence,{present:a||k(i.checked)||!0===i.checked,children:(0,t.jsx)(l.Primitive.span,{"data-state":N(i.checked),"data-disabled":i.disabled?"":void 0,...n,ref:r,style:{pointerEvents:"none",...e.style}})})});j.displayName=y;var S="CheckboxBubbleInput",w=r.forwardRef(({__scopeCheckbox:e,...a},n)=>{let{control:i,hasConsumerStoppedPropagationRef:d,checked:u,defaultChecked:h,required:m,disabled:p,name:f,value:g,form:v,bubbleInput:b,setBubbleInput:y}=x(S,e),j=(0,s.useComposedRefs)(n,y),w=(0,o.usePrevious)(u),N=(0,c.useSize)(i);r.useEffect(()=>{if(!b)return;let e=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set,t=!d.current;if(w!==u&&e){let r=new Event("click",{bubbles:t});b.indeterminate=k(u),e.call(b,!k(u)&&u),b.dispatchEvent(r)}},[b,w,u,d]);let T=r.useRef(!k(u)&&u);return(0,t.jsx)(l.Primitive.input,{type:"checkbox","aria-hidden":!0,defaultChecked:h??T.current,required:m,disabled:p,name:f,value:g,form:v,...a,tabIndex:-1,ref:j,style:{...a.style,...N,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});function k(e){return"indeterminate"===e}function N(e){return k(e)?"indeterminate":e?"checked":"unchecked"}w.displayName=S;var T=e.i(58592),_=e.i(47163);function R({className:e,...r}){return(0,t.jsx)(b,{"data-slot":"checkbox",className:(0,_.cn)("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...r,children:(0,t.jsx)(j,{"data-slot":"checkbox-indicator",className:"grid place-content-center text-current transition-none",children:(0,t.jsx)(T.CheckIcon,{className:"size-3.5"})})})}e.s(["Checkbox",()=>R],25959)},95187,e=>{"use strict";var t=e.i(83638),r=e.i(43447),s=e.i(4520),a=e.i(60313),n=e.i(48303),i=e.i(11522),o=e.i(67881),c=e.i(94179),d=e.i(47627),l=e.i(23750),u=e.i(10708),h=e.i(30374),m=e.i(25959),p=e.i(54219),x=e.i(54858);function f(){let e=(0,s.useRouter)(),[f,g]=(0,r.useState)([]),[v,b]=(0,r.useState)(!1),[y,j]=(0,r.useState)(0),[S,w]=(0,r.useState)(1),[k,N]=(0,r.useState)(20),[T,_]=(0,r.useState)(""),[R,E]=(0,r.useState)([]),[C,$]=(0,r.useState)(!1),[A,I]=(0,r.useState)("create"),[O,P]=(0,r.useState)(null),[L,D]=(0,r.useState)(!1),[z,B]=(0,r.useState)(null),[M,F]=(0,r.useState)(!1),[H,U]=(0,r.useState)({code:"",name:"",description:""}),[W,G]=(0,r.useState)(!1);(0,r.useEffect)(()=>{if(!(0,x.getAccessToken)())return void e.push("/login")},[e]);let J=async()=>{try{let e=await (0,x.getPermissionsTree)();E(e)}catch(e){e instanceof x.ApiError?p.toast.error(e.message||"获取权限树失败"):p.toast.error("发生未知错误，请稍后重试")}};(0,r.useEffect)(()=>{(0,x.getAccessToken)()&&J()},[]);let q=async()=>{b(!0);try{let e=await (0,x.getRoles)({page:S,page_size:k,keyword:T||void 0});g(e.list),j(e.total)}catch(e){e instanceof x.ApiError?p.toast.error(e.message||"获取角色列表失败"):p.toast.error("发生未知错误，请稍后重试")}finally{b(!1)}};(0,r.useEffect)(()=>{(0,x.getAccessToken)()&&q()},[S,k,T]);let K=async e=>{D(!0),F(!0),B(null);try{let t=await (0,x.getRole)(e.id);B(t)}catch(e){e instanceof x.ApiError?p.toast.error(e.message||"获取角色详情失败"):p.toast.error("发生未知错误，请稍后重试")}finally{F(!1)}},Y=async(e,t)=>{if(confirm(`确定要删除角色 "${t}" 吗？`))try{await (0,x.deleteRole)(e),p.toast.success("删除成功"),q()}catch(e){e instanceof x.ApiError?p.toast.error(e.message||"删除失败"):p.toast.error("发生未知错误，请稍后重试")}},V=async e=>{I("edit"),P(e),G(!0);try{let t=await (0,x.getRole)(e.id),r=t.permissions?.map(e=>e.id)||[];U({code:t.code,name:t.name,description:t.description||"",permission_ids:r}),$(!0)}catch(e){e instanceof x.ApiError?p.toast.error(e.message||"获取角色详情失败"):p.toast.error("发生未知错误，请稍后重试")}finally{G(!1)}},X=async e=>{if(e.preventDefault(),!H.code)return void p.toast.error("角色代码不能为空");if(!H.name)return void p.toast.error("角色名称不能为空");if(H.code.length<2)return void p.toast.error("角色代码至少为 2 位");if(H.name.length<2)return void p.toast.error("角色名称至少为 2 个字符");G(!0);try{"create"===A?(await (0,x.createRole)({code:H.code,name:H.name,description:H.description}),p.toast.success("创建成功")):"edit"===A&&O&&(await (0,x.updateRole)(O.id,{code:H.code,name:H.name,description:H.description}),H.permission_ids&&await (0,x.assignPermissionsToRole)(O.id,H.permission_ids),p.toast.success("更新成功")),$(!1),U({code:"",name:"",description:"",permission_ids:[]}),q()}catch(e){e instanceof x.ApiError?p.toast.error(e.message||("create"===A?"创建失败":"更新失败")):p.toast.error("发生未知错误，请稍后重试")}finally{G(!1)}},Q=Math.ceil(y/k);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(i.SidebarProvider,{style:{"--sidebar-width":"calc(var(--spacing) * 72)","--header-height":"calc(var(--spacing) * 12)"},children:[(0,t.jsx)(a.AppSidebar,{variant:"inset"}),(0,t.jsxs)(i.SidebarInset,{children:[(0,t.jsx)(n.SiteHeader,{}),(0,t.jsx)("div",{className:"flex flex-1 flex-col",children:(0,t.jsx)("div",{className:"@container/main flex flex-1 flex-col gap-2",children:(0,t.jsxs)("div",{className:"flex flex-col gap-4 px-4 py-4 lg:px-6 lg:py-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"角色管理"}),(0,t.jsx)(o.Button,{onClick:()=>{I("create"),P(null),U({code:"",name:"",description:"",permission_ids:[]}),$(!0)},children:"添加角色"})]}),(0,t.jsx)("div",{className:"flex gap-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(u.Label,{htmlFor:"keyword",children:"搜索"}),(0,t.jsx)(l.Input,{id:"keyword",value:T,onChange:e=>_(e.target.value),placeholder:"角色代码或名称",className:"w-48"}),(0,t.jsx)(o.Button,{onClick:()=>{w(1),q()},disabled:v,children:"搜索"})]})}),(0,t.jsx)("div",{className:"rounded-lg border",children:(0,t.jsxs)(d.Table,{children:[(0,t.jsx)(d.TableHeader,{children:(0,t.jsxs)(d.TableRow,{children:[(0,t.jsx)(d.TableHead,{children:"角色代码"}),(0,t.jsx)(d.TableHead,{children:"角色名称"}),(0,t.jsx)(d.TableHead,{children:"类型"}),(0,t.jsx)(d.TableHead,{children:"操作"})]})}),(0,t.jsx)(d.TableBody,{children:v?(0,t.jsx)(d.TableRow,{children:(0,t.jsx)(d.TableCell,{colSpan:4,className:"text-center",children:"加载中..."})}):0===f.length?(0,t.jsx)(d.TableRow,{children:(0,t.jsx)(d.TableCell,{colSpan:4,className:"text-center",children:"暂无数据"})}):f.map(e=>(0,t.jsxs)(d.TableRow,{children:[(0,t.jsx)(d.TableCell,{className:"font-medium",children:e.code}),(0,t.jsx)(d.TableCell,{children:e.name}),(0,t.jsx)(d.TableCell,{children:(0,t.jsx)(c.Badge,{variant:e.is_system?"default":"secondary",children:e.is_system?"系统角色":"自定义"})}),(0,t.jsx)(d.TableCell,{children:(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(o.Button,{variant:"ghost",size:"sm",onClick:()=>K(e),children:"详情"}),(0,t.jsx)(o.Button,{variant:"ghost",size:"sm",onClick:()=>V(e),children:"编辑"}),(0,t.jsx)(o.Button,{variant:"ghost",size:"sm",onClick:()=>Y(e.id,e.name),children:"删除"})]})})]},e.id))})]})}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:["共 ",y," 条记录，当前第 ",S," / ",Q," 页"]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(o.Button,{variant:"outline",size:"sm",onClick:()=>w(e=>Math.max(1,e-1)),disabled:v||S<=1,children:"上一页"}),(0,t.jsx)(o.Button,{variant:"outline",size:"sm",onClick:()=>w(e=>Math.min(Q,e+1)),disabled:v||S>=Q,children:"下一页"})]})]})]})})})]})]}),(0,t.jsx)(h.Dialog,{open:L,onOpenChange:D,children:(0,t.jsxs)(h.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)(h.DialogHeader,{children:[(0,t.jsx)(h.DialogTitle,{children:"角色详情"}),(0,t.jsx)(h.DialogDescription,{children:"查看角色的完整信息和权限绑定关系"})]}),M?(0,t.jsx)("div",{className:"py-8 text-center",children:"加载中..."}):z?(0,t.jsxs)("div",{className:"space-y-4 py-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(u.Label,{className:"text-muted-foreground",children:"角色代码"}),(0,t.jsx)("div",{className:"font-medium",children:z.code})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(u.Label,{className:"text-muted-foreground",children:"角色名称"}),(0,t.jsx)("div",{children:z.name})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(u.Label,{className:"text-muted-foreground",children:"类型"}),(0,t.jsx)("div",{children:(0,t.jsx)(c.Badge,{variant:z.is_system?"default":"secondary",children:z.is_system?"系统角色":"自定义"})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(u.Label,{className:"text-muted-foreground",children:"描述"}),(0,t.jsx)("div",{children:z.description||"-"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(u.Label,{className:"text-muted-foreground",children:"创建时间"}),(0,t.jsx)("div",{children:new Date(z.created_at).toLocaleString("zh-CN")})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(u.Label,{className:"text-muted-foreground",children:"更新时间"}),(0,t.jsx)("div",{children:new Date(z.updated_at).toLocaleString("zh-CN")})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(u.Label,{className:"text-muted-foreground mb-2 block",children:"绑定权限"}),(0,t.jsx)("div",{className:"rounded-md border p-4 max-h-64 overflow-y-auto",children:z.permissions&&z.permissions.length>0?(0,t.jsx)("div",{className:"space-y-2",children:z.permissions.map(e=>(0,t.jsxs)("div",{className:"text-sm",children:[e.name," (",e.code,")"]},e.id))}):(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"暂无绑定权限"})})]})]}):null,(0,t.jsx)(h.DialogFooter,{children:(0,t.jsx)(o.Button,{onClick:()=>D(!1),children:"关闭"})})]})}),(0,t.jsx)(h.Dialog,{open:C,onOpenChange:$,children:(0,t.jsxs)(h.DialogContent,{children:[(0,t.jsxs)(h.DialogHeader,{children:[(0,t.jsx)(h.DialogTitle,{children:"create"===A?"添加角色":"编辑角色"}),(0,t.jsx)(h.DialogDescription,{children:"create"===A?"请填写角色信息":"请更新角色信息"})]}),(0,t.jsxs)("form",{onSubmit:X,children:[(0,t.jsxs)("div",{className:"space-y-4 py-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u.Label,{htmlFor:"code",children:"角色代码 *"}),(0,t.jsx)(l.Input,{id:"code",value:H.code,onChange:e=>U({...H,code:e.target.value}),placeholder:"请输入角色代码（如 ADMIN, USER）",required:!0,disabled:W||"edit"===A,maxLength:50})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u.Label,{htmlFor:"name",children:"角色名称 *"}),(0,t.jsx)(l.Input,{id:"name",value:H.name,onChange:e=>U({...H,name:e.target.value}),placeholder:"请输入角色名称",required:!0,disabled:W,maxLength:100})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u.Label,{htmlFor:"description",children:"描述"}),(0,t.jsx)(l.Input,{id:"description",value:H.description,onChange:e=>U({...H,description:e.target.value}),placeholder:"请输入角色描述（可选）",disabled:W,maxLength:200})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u.Label,{children:"权限"}),(0,t.jsx)("div",{className:"rounded-md border p-4 max-h-64 overflow-y-auto",children:R.length>0?function e(r,s,a,n,i=0){return r.map(r=>(0,t.jsxs)("div",{style:{marginLeft:20*i},children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,t.jsx)(m.Checkbox,{id:`permission-${r.id}`,checked:s.permission_ids?.includes(r.id)||!1,onCheckedChange:e=>{let t=e?[...s.permission_ids||[],r.id]:(s.permission_ids||[]).filter(e=>e!==r.id);a({...s,permission_ids:t})},disabled:n}),(0,t.jsxs)("label",{htmlFor:`permission-${r.id}`,className:"text-sm flex-1",children:[r.name," (",r.code,")"]})]}),r.children&&r.children.length>0&&e(r.children,s,a,n,i+1)]},r.id))}(R,H,U,W):(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"暂无权限"})})]})]}),(0,t.jsxs)(h.DialogFooter,{children:[(0,t.jsx)(o.Button,{type:"button",variant:"outline",onClick:()=>$(!1),disabled:W,children:"取消"}),(0,t.jsx)(o.Button,{type:"submit",disabled:W,children:W?"create"===A?"创建中...":"更新中...":"create"===A?"确认创建":"确认更新"})]})]})]})})]})}e.s(["default",()=>f])}]);